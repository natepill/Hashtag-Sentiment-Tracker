<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">

  <title>Hashtag Emotion Visualization</title>

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS"
    crossorigin="anonymous">
  <link rel="stylesheet" href="../static/css/main.css">
  <link rel="stylesheet" href="../static/css/chart_style.css">

</head>

<body>
  <!-- NOTE: May have to include hidden input for hashtag to make request with to server to start stream -->
  <input type="hidden" id="hashtag_id" value={{hashtag}}>
  <input type="hidden" id="time_id" value={{curr_time}}>


  <!-- <input type="hidden" value= {{values}} id='frequencies'>
  <input type="hidden" value= {{labels}} id='emotion_classes'> -->

  <div class="wrapper">
    <div class="container d-flex flex-column justify-content-center align-items-center">
      <div class="title text-center mb-5">
        <h1>How Does Twitter Feel About: </h1>
        <h6> INSERT LIST OF HASHTAGS HERE </h6>

      </div>
      <div class="chart-wrapper">
        <canvas id="pie-chart" width="800" height="450"> </canvas>
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

  <!-- <script src="../static/js/actual_pie_chart.js"></script> -->
  <!-- <script src="../static/js/pie_script.js"></script> -->


  <!-- NOTE: Some things dont exist in client side JS in difference to sever side. IE: cannot require on client side with 3rd party -->
  <script>

  // define the chart data
 var chartData = {
   labels : [{% for item in labels %}
              "{{item}}",
             {% endfor %}],
   datasets : [{
       label: '{{ legend }}',
       fill: true,
       lineTension: 0.1,
       backgroundColor: "rgba(75,192,192,0.4)",
       borderColor: "rgba(75,192,192,1)",
       borderCapStyle: 'butt',
       borderDash: [],
       borderDashOffset: 0.0,
       borderJoinStyle: 'miter',
       pointBorderColor: "rgba(75,192,192,1)",
       pointBackgroundColor: "#fff",
       pointBorderWidth: 1,
       pointHoverRadius: 5,
       pointHoverBackgroundColor: "rgba(75,192,192,1)",
       pointHoverBorderColor: "rgba(220,220,220,1)",
       pointHoverBorderWidth: 2,
       pointRadius: 1,
       pointHitRadius: 10,
       data : [{% for item in values %}
                 {{item}},
               {% endfor %}],
       spanGaps: false
   }]
 }



      new Chart(document.getElementById("pie-chart"), {
          type: 'pie',
          data: {
            labels: [{% for item in labels %}
                       "{{item}}",
                      {% endfor %}],
            datasets: [{
              label: "Population (millions)",
              backgroundColor: ["#3e95cd", "#8e5ea2","#3cba9f","#e8c3b9","#c45850"],
              data: [{% for item in values %}
                        {{item}},
                      {% endfor %}]
            }]
          },
          options: {
            title: {
              display: true,
              text: 'Predicted world population (millions) in 2050'
            }
          }
      });





    window.onload = function() {

        // let ctx = document.getElementById('myChart').getContext('2d');
        // let colorHex = ['#a91834', '#4B1858', '#ffffff', '#00daff', '#006633', '#8cff1f', '#000000', '#d86a77', '#EEEEEE', '#a9b6aa', '#f3d8a5', '#353D5B', '#97bd91'];

        console.log("HELLO")
        // console.log(`values: ${frequencies}`);
        // console.log(`labels: ${labels}`);

      } // End Window onload



  </script>








  <!-- <script>
      var userHashtag = document.getElementById('hashtag_id').value
      var curr_time = document.getElementById('time_id').value
      console.log(`Hashtag: ${userHashtag}`)
      console.log(`Current Time: ${curr_time}`)

      window.onload = function() {

        };



    // NOTE: look into: JSON.parse(this.responseText) for once we get the data successfully from server
    // const getData = async() => {
    //     try {
    //       return await axios.get('http://127.0.0.1:5000/get_classifications')
    //     } catch (error) {
    //       console.error(error)
    //     }
    //   }

    // console.log(getData)
    function getData(){

        const options = {
            method: 'post',
            body: JSON.stringify({
              userHashtag: userHashtag,
              curr_time: curr_time
            }),
            headers: {
              'Accept': 'application/json',
              'Content-Type': 'application/json'
            }
        }


        fetch('http://127.0.0.1:5000/get_classifications', options).then((res) => {
          console.log("RETURNING RESPONSE *******************")
          console.log(res)
          return res.text()
        }).then((json) => {
          const data = JSON.parse(json)
          console.log(data)

        }).catch((err) => {

          console.log(err.message)
          return ["Error"]
        })
    }

  </script> -->





</body>

</html>
